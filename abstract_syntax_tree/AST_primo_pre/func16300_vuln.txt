`-FunctionDecl 0x158128758  line:1:1 protocol_handshake 'int (struct connection *)'
  |-ParmVarDecl 0x158128648 <col:21, col:40> col:40 used conn 'struct connection *'
  `-CompoundStmt 0x1581412d0 <line:2:1, line:13:1>
    |-DeclStmt 0x158140ad0 <line:3:3, col:8>
    | `-VarDecl 0x158140a68 <col:3, col:7> col:7 used r 'int'
    |-CallExpr 0x158140c98 <line:5:3, col:21> 'int'
    | |-ImplicitCastExpr 0x158140c80 <col:3> 'int (*)()' <FunctionToPointerDecay>
    | | `-DeclRefExpr 0x158140c10 <col:3> 'int ()' Function 0x158140b58 'lock_request' 'int ()'
    | `-ImplicitCastExpr 0x158140cc0 <col:17> 'struct connection *' <LValueToRValue>
    |   `-DeclRefExpr 0x158140c30 <col:17> 'struct connection *' lvalue ParmVar 0x158128648 'conn' 'struct connection *'
    |-IfStmt 0x1581410e0 <line:6:3, line:9:42> has_else
    | |-UnaryOperator 0x158140d58 <line:6:7, col:8> '<dependent type>' contains-errors prefix '!' cannot overflow
    | | `-ImplicitCastExpr 0x158140d40 <col:8> '<dependent type>' contains-errors <LValueToRValue>
    | |   `-RecoveryExpr 0x158140d20 <col:8> '<dependent type>' contains-errors lvalue
    | |-BinaryOperator 0x158140f08 <line:7:5, col:42> 'int' '='
    | | |-DeclRefExpr 0x158140d70 <col:5> 'int' lvalue Var 0x158140a68 'r' 'int'
    | | `-CallExpr 0x158140ec8 <col:9, col:42> 'int'
    | |   |-ImplicitCastExpr 0x158140eb0 <col:9> 'int (*)()' <FunctionToPointerDecay>
    | |   | `-DeclRefExpr 0x158140e70 <col:9> 'int ()' Function 0x158140db8 'protocol_handshake_oldstyle' 'int ()'
    | |   `-ImplicitCastExpr 0x158140ef0 <col:38> 'struct connection *' <LValueToRValue>
    | |     `-DeclRefExpr 0x158140e90 <col:38> 'struct connection *' lvalue ParmVar 0x158128648 'conn' 'struct connection *'
    | `-BinaryOperator 0x1581410c0 <line:9:5, col:42> 'int' '='
    |   |-DeclRefExpr 0x158140f28 <col:5> 'int' lvalue Var 0x158140a68 'r' 'int'
    |   `-CallExpr 0x158141080 <col:9, col:42> 'int'
    |     |-ImplicitCastExpr 0x158141068 <col:9> 'int (*)()' <FunctionToPointerDecay>
    |     | `-DeclRefExpr 0x158141028 <col:9> 'int ()' Function 0x158140f70 'protocol_handshake_newstyle' 'int ()'
    |     `-ImplicitCastExpr 0x1581410a8 <col:38> 'struct connection *' <LValueToRValue>
    |       `-DeclRefExpr 0x158141048 <col:38> 'struct connection *' lvalue ParmVar 0x158128648 'conn' 'struct connection *'
    |-CallExpr 0x158141248 <line:10:3, col:23> 'int'
    | |-ImplicitCastExpr 0x158141230 <col:3> 'int (*)()' <FunctionToPointerDecay>
    | | `-DeclRefExpr 0x1581411f0 <col:3> 'int ()' Function 0x158141138 'unlock_request' 'int ()'
    | `-ImplicitCastExpr 0x158141270 <col:19> 'struct connection *' <LValueToRValue>
    |   `-DeclRefExpr 0x158141210 <col:19> 'struct connection *' lvalue ParmVar 0x158128648 'conn' 'struct connection *'
    `-ReturnStmt 0x1581412c0 <line:12:3, col:10>
      `-ImplicitCastExpr 0x1581412a8 <col:10> 'int' <LValueToRValue>
        `-DeclRefExpr 0x158141288 <col:10> 'int' lvalue Var 0x158140a68 'r' 'int'
