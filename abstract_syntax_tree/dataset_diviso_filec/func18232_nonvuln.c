HttpDownstreamConnection::HttpDownstreamConnection(
    const std::shared_ptr<DownstreamAddrGroup> &group, DownstreamAddr *addr,
    struct ev_loop *loop, Worker *worker)
    : conn_(loop, -1, nullptr, worker->get_mcpool(),
            group->shared_addr->timeout.write, group->shared_addr->timeout.read,
            {}, {}, connectcb, readcb, connect_timeoutcb, this,
            get_config()->tls.dyn_rec.warmup_threshold,
            get_config()->tls.dyn_rec.idle_timeout, Proto::HTTP1),
      on_read_(&HttpDownstreamConnection::noop),
      on_write_(&HttpDownstreamConnection::noop),
      signal_write_(&HttpDownstreamConnection::noop),
      worker_(worker),
      ssl_ctx_(worker->get_cl_ssl_ctx()),
      group_(group),
      addr_(addr),
      raddr_(nullptr),
      ioctrl_(&conn_.rlimit),
      response_htp_{0},
      first_write_done_(false),
      reusable_(true),
      request_header_written_(false) {}